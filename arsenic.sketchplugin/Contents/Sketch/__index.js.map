{"version":3,"sources":["webpack://exports/webpack/bootstrap","webpack://exports/./node_modules/@skpm/promise/index.js","webpack://exports/./node_modules/mocha-js-delegate/index.js","webpack://exports/./node_modules/sketch-module-web-view/lib/browser-api.js","webpack://exports/./node_modules/sketch-module-web-view/lib/constants.js","webpack://exports/./node_modules/sketch-module-web-view/lib/dispatch-first-click.js","webpack://exports/./node_modules/sketch-module-web-view/lib/execute-javascript.js","webpack://exports/./node_modules/sketch-module-web-view/lib/fitSubview.js","webpack://exports/./node_modules/sketch-module-web-view/lib/index.js","webpack://exports/./node_modules/sketch-module-web-view/lib/inject-client-messaging.js","webpack://exports/./node_modules/sketch-module-web-view/lib/movable-area.js","webpack://exports/./node_modules/sketch-module-web-view/lib/parseWebArguments.js","webpack://exports/./node_modules/sketch-module-web-view/lib/set-delegates.js","webpack://exports/./node_modules/sketch-module-web-view/lib/webview-api.js","webpack://exports/./node_modules/sketch-module-web-view/remote.js","webpack://exports/./resources/index.html","webpack://exports/./resources/plugin-options.html","webpack://exports/./src/changeSketchAssets.js","webpack://exports/./src/colorCalculations.js","webpack://exports/./src/index.js","webpack://exports/external \"events\"","webpack://exports/external \"sketch\"","webpack://exports/external \"sketch/ui\""],"names":["isArsenicDesignSystem","sharedLayerStyles","isArsenic","filter","layer","name","match","length","console","log","err","capitalizeString","inputString","charAt","toUpperCase","slice","updatePrimaryBorders","allLayerStyles","colorToReplace","regex","filteredLayers","updateBorderLayers","changeColorShadeAssets","hexColorCode","whichColors","minL","maxL","selectedColor","colorCalc","numOfNuances","j","i","colorRegex","colorCode","colorRegex500","k","forEach","sharedStyle","type","style","fills","color","borders","arrStyleLayers","getAllInstancesLayers","aCurrentStyleLayer","syncWithSharedStyle","RGBToHSL","r","g","b","cmin","Math","min","cmax","max","delta","h","s","l","hexToHSL","H","round","abs","toFixed","HSLToHex","c","x","m","toString","calLigntness","isDark","selectedLightness","maxLightness","parseInt","maxStep","minLightness","minStep","lightNess","webviewIdentifier","document","sketch","getSelectedDocument","options","identifier","width","height","show","resizable","movable","fullscreen","browserWindow","BrowserWindow","baseColors","webContents","sketchAssets","once","on","UI","message","splitDocPath","path","split","documentName","executeJavaScript","JSON","stringify","catch","getBase500Colors","getFontsList","inputId","hexColor","minLuminence","maxLuminence","swatchName","swatchContainer","sketchObject","documentData","sharedSwatches","mySwatchs","swatches","isColorExist","find","data","value","swatch","newHexColor","MSColor","colorWithHex_alpha","updateWithColor","updateReferencesToSwatch","fontTypeLayers","fontName","newFontTypeLayers","replace","updateFontStyle","whichElement","initialColors","onShutdown","url","NSWorkspace","sharedWorkspace","openURL","NSURL","URLWithString","availableFontFamilies","NSFontManager","sharedFontManager","arrayFontList","Array","from","objFontList","Object","entries","String","textStyles","sharedTextStyles","filteredTextStylesToUpdate","fontFamily","layers","fontLayers","layerStyles","isReset","filteredBaseLayers","map","sharedLayerStyle","key","colorName","colorCodeObj","toLowerCase","isPrimary","isColorChanged","push","loadURL","require","existingWebview","getWebview","close"],"mappings":";;;;;;;;QAAA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;;QAGA;QACA;;;;;;;;;;;;AClFA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;;AAEA;AACA;AACA,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA,aAAa,QAAQ;AACrB;AACA,aAAa,SAAS;AACtB;AACA,aAAa,kBAAkB;AAC/B;AACA,aAAa,kBAAkB;AAC/B;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA,+CAA+C,SAAS;AACxD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA,mBAAmB,iBAAiB;AACpC;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;;AAEA,qCAAqC,SAAS;AAC9C;AACA;AACA,GAAG;AACH;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;;AC9QA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAc,wDAAwD,EAAE;AACxE;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL,uCAAuC;AACvC;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;AACA;;;;;;;;;;;;AC/FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,mBAAmB,OAAO;AAC1B;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT,OAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,oCAAoC,+BAA+B;AACnE;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO,+BAA+B;AACtC;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,oCAAoC,aAAa;AACjD;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AC5lBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACRA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,yCAAyC;AACzC,uDAAuD;AACvD,6DAA6D;AAC7D,+BAA+B;AAC/B,MAAM;AACN;AACA;AACA;AACA,QAAQ;AACR,gBAAgB;AAChB,MAAM,eAAe;AACrB,0CAA0C,cAAc;AACxD,MAAM;AACN;AACA;;;;;;;;;;;;ACzBA,+DAAgB,mBAAO,CAAC,2EAAa;;AAErC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,8BAA8B;AAC9B,YAAY;AACZ,gCAAgC;AAChC,wFAAwF;AACxF,qCAAqC;AACrC;AACA;AACA,mBAAmB;AACnB,YAAY;AACZ,kCAAkC;AAClC;AACA;AACA,kBAAkB;AAClB,YAAY;AACZ,UAAU,OAAO;AACjB;AACA;AACA,kBAAkB;AAClB,UAAU;AACV,QAAQ,cAAc;AACtB;AACA;AACA,kBAAkB;AAClB,QAAQ;AACR,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACpHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACrBA;AACA;AACA,mBAAmB,mBAAO,CAAC,sBAAQ;AACnC,sBAAsB,mBAAO,CAAC,+EAAe;AAC7C,kBAAkB,mBAAO,CAAC,+EAAe;AACzC,uBAAuB,mBAAO,CAAC,6EAAc;AAC7C,yBAAyB,mBAAO,CAAC,iGAAwB;AACzD,4BAA4B,mBAAO,CAAC,uGAA2B;AAC/D,kBAAkB,mBAAO,CAAC,iFAAgB;AAC1C,wBAAwB,mBAAO,CAAC,6FAAsB;AACtD,mBAAmB,mBAAO,CAAC,mFAAiB;;AAE5C;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA,KAAK;AACL;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;;AAEA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,iBAAiB,qBAAqB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;;;;;;;;;;;ACzWA,gBAAgB,mBAAO,CAAC,2EAAa;;AAErC;AACA;AACA,qDAAqD;AACrD,gDAAgD;AAChD,yBAAyB;AACzB;AACA,QAAQ;AACR,uDAAuD;AACvD,6CAA6C;AAC7C,0BAA0B;AAC1B,sDAAsD;AACtD;AACA;AACA,uBAAuB;AACvB;AACA;AACA,sBAAsB;AACtB;AACA;AACA,wCAAwC;AACxC,QAAQ,EAAE;AACV,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AC9BA,gBAAgB,mBAAO,CAAC,2EAAa;;AAErC;AACA;AACA,mBAAmB;AACnB,yDAAyD;AACzD;AACA,kCAAkC;AAClC,2CAA2C,4BAA4B,eAAe;AACtF,gCAAgC,yBAAyB,cAAc;AACvE;AACA,OAAO;AACP;AACA,8BAA8B;AAC9B,qDAAqD,SAAS;AAC9D;AACA;AACA,QAAQ;AACR,OAAO;AACP,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAG;AACH;;;;;;;;;;;;AC5DA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;;;;;;;;;;AClBA,+DAAgB,mBAAO,CAAC,oEAAmB;AAC3C,wBAAwB,mBAAO,CAAC,2FAAqB;AACrD,gBAAgB,mBAAO,CAAC,2EAAa;;AAErC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAO;;AAEP;AACA;AACA,OAAO;;AAEP;AACA;AACA,OAAO;;AAEP;AACA;AACA,OAAO;;AAEP;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,WAAW;AACX,SAAS;AACT;AACA,OAAO;;AAEP;AACA;AACA,OAAO;;AAEP;AACA;AACA,OAAO;;AAEP;AACA;AACA,OAAO;AACP,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA,2CAA2C;AAC3C,OAAO;;AAEP;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA,UAAU;;AAEV;AACA;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA,OAAO;;AAEP;AACA;;AAEA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,OAAO;AACP,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL,GAAG;;AAEH;AACA,+DAA+D;AAC/D;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA,KAAK;AACL,GAAG;;AAEH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,uBAAuB,sBAAsB;;AAE7C;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,OAAO;AACP;AACA,KAAK;AACL,GAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;;;;;;;;;;;;ACtZA,mBAAmB,mBAAO,CAAC,sBAAQ;AACnC,wBAAwB,mBAAO,CAAC,6FAAsB;;AAEtD;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD;AACnD;AACA,QAAQ,kCAAkC;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;;;;;;;;;;;AC/NA;AACA;;AAEA;AACA,SAAS,mBAAO,CAAC,iEAAO;AACxB;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB,qBAAqB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;;;;;;;;;;;AClCA,gM;;;;;;;;;;;ACAA,gM;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEO,IAAMA,qBAAqB,GAAG,SAAxBA,qBAAwB,CAACC,iBAAD,EAAuB;AAC1D,MAAI;AACF;AACA,QAAMC,SAAS,GAAGD,iBAAiB,CAACE,MAAlB,CAChB,UAACC,KAAD;AAAA,aACE,CAACA,KAAK,CAACC,IAAN,CAAWC,KAAX,CAAiB,WAAjB,KACCF,KAAK,CAACC,IAAN,CAAWC,KAAX,CAAiB,aAAjB,CADD,IAECF,KAAK,CAACC,IAAN,CAAWC,KAAX,CAAiB,YAAjB,CAFF,KAGAF,KAAK,CAACC,IAAN,CAAWC,KAAX,CAAiB,aAAjB,CAJF;AAAA,KADgB,CAAlB;;AAQA,QAAIJ,SAAS,CAACK,MAAV,IAAoB,CAAxB,EAA2B;AACzB;AACA;AACAC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","file":"__index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.js\");\n","/* from https://github.com/taylorhakes/promise-polyfill */\n\nfunction promiseFinally(callback) {\n  var constructor = this.constructor;\n  return this.then(\n    function(value) {\n      return constructor.resolve(callback()).then(function() {\n        return value;\n      });\n    },\n    function(reason) {\n      return constructor.resolve(callback()).then(function() {\n        return constructor.reject(reason);\n      });\n    }\n  );\n}\n\nfunction noop() {}\n\n/**\n * @constructor\n * @param {Function} fn\n */\nfunction Promise(fn) {\n  if (!(this instanceof Promise))\n    throw new TypeError(\"Promises must be constructed via new\");\n  if (typeof fn !== \"function\") throw new TypeError(\"not a function\");\n  /** @type {!number} */\n  this._state = 0;\n  /** @type {!boolean} */\n  this._handled = false;\n  /** @type {Promise|undefined} */\n  this._value = undefined;\n  /** @type {!Array<!Function>} */\n  this._deferreds = [];\n\n  doResolve(fn, this);\n}\n\nfunction handle(self, deferred) {\n  while (self._state === 3) {\n    self = self._value;\n  }\n  if (self._state === 0) {\n    self._deferreds.push(deferred);\n    return;\n  }\n  self._handled = true;\n  Promise._immediateFn(function() {\n    var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n    if (cb === null) {\n      (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n      return;\n    }\n    var ret;\n    try {\n      ret = cb(self._value);\n    } catch (e) {\n      reject(deferred.promise, e);\n      return;\n    }\n    resolve(deferred.promise, ret);\n  });\n}\n\nfunction resolve(self, newValue) {\n  try {\n    // Promise Resolution Procedure: https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n    if (newValue === self)\n      throw new TypeError(\"A promise cannot be resolved with itself.\");\n    if (\n      newValue &&\n      (typeof newValue === \"object\" || typeof newValue === \"function\")\n    ) {\n      var then = newValue.then;\n      if (newValue instanceof Promise) {\n        self._state = 3;\n        self._value = newValue;\n        finale(self);\n        return;\n      } else if (typeof then === \"function\") {\n        doResolve(then.bind(newValue), self);\n        return;\n      }\n    }\n    self._state = 1;\n    self._value = newValue;\n    finale(self);\n  } catch (e) {\n    reject(self, e);\n  }\n}\n\nfunction reject(self, newValue) {\n  self._state = 2;\n  self._value = newValue;\n  finale(self);\n}\n\nfunction finale(self) {\n  if (self._state === 2 && self._deferreds.length === 0) {\n    Promise._immediateFn(function() {\n      if (!self._handled) {\n        Promise._unhandledRejectionFn(self._value, self);\n      }\n    });\n  }\n\n  for (var i = 0, len = self._deferreds.length; i < len; i++) {\n    handle(self, self._deferreds[i]);\n  }\n  self._deferreds = null;\n}\n\n/**\n * @constructor\n */\nfunction Handler(onFulfilled, onRejected, promise) {\n  this.onFulfilled = typeof onFulfilled === \"function\" ? onFulfilled : null;\n  this.onRejected = typeof onRejected === \"function\" ? onRejected : null;\n  this.promise = promise;\n}\n\n/**\n * Take a potentially misbehaving resolver function and make sure\n * onFulfilled and onRejected are only called once.\n *\n * Makes no guarantees about asynchrony.\n */\nfunction doResolve(fn, self) {\n  var done = false;\n  try {\n    fn(\n      function(value) {\n        if (done) {\n          Promise._multipleResolvesFn(\"resolve\", self, value);\n          return;\n        }\n        done = true;\n        resolve(self, value);\n      },\n      function(reason) {\n        if (done) {\n          Promise._multipleResolvesFn(\"reject\", self, reason);\n          return;\n        }\n        done = true;\n        reject(self, reason);\n      }\n    );\n  } catch (ex) {\n    if (done) {\n      Promise._multipleResolvesFn(\"reject\", self, ex);\n      return;\n    }\n    done = true;\n    reject(self, ex);\n  }\n}\n\nPromise.prototype[\"catch\"] = function(onRejected) {\n  return this.then(null, onRejected);\n};\n\nPromise.prototype.then = function(onFulfilled, onRejected) {\n  // @ts-ignore\n  var prom = new this.constructor(noop);\n\n  handle(this, new Handler(onFulfilled, onRejected, prom));\n  return prom;\n};\n\nPromise.prototype[\"finally\"] = promiseFinally;\n\nPromise.all = function(arr) {\n  return new Promise(function(resolve, reject) {\n    if (!Array.isArray(arr)) {\n      return reject(new TypeError(\"Promise.all accepts an array\"));\n    }\n\n    var args = Array.prototype.slice.call(arr);\n    if (args.length === 0) return resolve([]);\n    var remaining = args.length;\n\n    function res(i, val) {\n      try {\n        if (val && (typeof val === \"object\" || typeof val === \"function\")) {\n          var then = val.then;\n          if (typeof then === \"function\") {\n            then.call(\n              val,\n              function(val) {\n                res(i, val);\n              },\n              reject\n            );\n            return;\n          }\n        }\n        args[i] = val;\n        if (--remaining === 0) {\n          resolve(args);\n        }\n      } catch (ex) {\n        reject(ex);\n      }\n    }\n\n    for (var i = 0; i < args.length; i++) {\n      res(i, args[i]);\n    }\n  });\n};\n\nPromise.resolve = function(value) {\n  if (value && typeof value === \"object\" && value.constructor === Promise) {\n    return value;\n  }\n\n  return new Promise(function(resolve) {\n    resolve(value);\n  });\n};\n\nPromise.reject = function(value) {\n  return new Promise(function(resolve, reject) {\n    reject(value);\n  });\n};\n\nPromise.race = function(arr) {\n  return new Promise(function(resolve, reject) {\n    if (!Array.isArray(arr)) {\n      return reject(new TypeError(\"Promise.race accepts an array\"));\n    }\n\n    for (var i = 0, len = arr.length; i < len; i++) {\n      Promise.resolve(arr[i]).then(resolve, reject);\n    }\n  });\n};\n\n// Use polyfill for setImmediate for performance gains\nPromise._immediateFn = setImmediate;\n\nPromise._unhandledRejectionFn = function _unhandledRejectionFn(err, promise) {\n  if (\n    typeof process !== \"undefined\" &&\n    process.listenerCount &&\n    (process.listenerCount(\"unhandledRejection\") ||\n      process.listenerCount(\"uncaughtException\"))\n  ) {\n    process.emit(\"unhandledRejection\", err, promise);\n    process.emit(\"uncaughtException\", err, \"unhandledRejection\");\n  } else if (typeof console !== \"undefined\" && console) {\n    console.warn(\"Possible Unhandled Promise Rejection:\", err);\n  }\n};\n\nPromise._multipleResolvesFn = function _multipleResolvesFn(\n  type,\n  promise,\n  value\n) {\n  if (typeof process !== \"undefined\" && process.emit) {\n    process.emit(\"multipleResolves\", type, promise, value);\n  }\n};\n\nmodule.exports = Promise;\n","/* globals MOClassDescription, NSObject, NSSelectorFromString, NSClassFromString, MOPropertyDescription */\n\nmodule.exports = function MochaDelegate(definition, superclass) {\n  var uniqueClassName =\n    'MochaJSDelegate_DynamicClass_' + NSUUID.UUID().UUIDString()\n\n  var delegateClassDesc = MOClassDescription.allocateDescriptionForClassWithName_superclass_(\n    uniqueClassName,\n    superclass || NSObject\n  )\n\n  // Storage\n  var handlers = {}\n  var ivars = {}\n\n  // Define an instance method\n  function setHandlerForSelector(selectorString, func) {\n    var handlerHasBeenSet = selectorString in handlers\n    var selector = NSSelectorFromString(selectorString)\n\n    handlers[selectorString] = func\n\n    /*\n      For some reason, Mocha acts weird about arguments: https://github.com/logancollins/Mocha/issues/28\n      We have to basically create a dynamic handler with a likewise dynamic number of predefined arguments.\n    */\n    if (!handlerHasBeenSet) {\n      var args = []\n      var regex = /:/g\n      while (regex.exec(selectorString)) {\n        args.push('arg' + args.length)\n      }\n\n      // eslint-disable-next-line no-eval\n      var dynamicFunction = eval(\n        '(function (' +\n          args.join(', ') +\n          ') { return handlers[selectorString].apply(this, arguments); })'\n      )\n\n      delegateClassDesc.addInstanceMethodWithSelector_function(\n        selector,\n        dynamicFunction\n      )\n    }\n  }\n\n  // define a property\n  function setIvar(key, value) {\n    var ivarHasBeenSet = key in handlers\n\n    ivars[key] = value\n\n    if (!ivarHasBeenSet) {\n      delegateClassDesc.addInstanceVariableWithName_typeEncoding(key, '@')\n      var description = MOPropertyDescription.new()\n      description.name = key\n      description.typeEncoding = '@'\n      description.weak = true\n      description.ivarName = key\n      delegateClassDesc.addProperty(description)\n    }\n  }\n\n  this.getClass = function() {\n    return NSClassFromString(uniqueClassName)\n  }\n\n  this.getClassInstance = function(instanceVariables) {\n    var instance = NSClassFromString(uniqueClassName).new()\n    Object.keys(ivars).forEach(function(key) {\n      instance[key] = ivars[key]\n    })\n    Object.keys(instanceVariables || {}).forEach(function(key) {\n      instance[key] = instanceVariables[key]\n    })\n    return instance\n  }\n  // alias\n  this.new = this.getClassInstance\n\n  // Convenience\n  if (typeof definition === 'object') {\n    Object.keys(definition).forEach(\n      function(key) {\n        if (typeof definition[key] === 'function') {\n          setHandlerForSelector(key, definition[key])\n        } else {\n          setIvar(key, definition[key])\n        }\n      }\n    )\n  }\n\n  delegateClassDesc.registerClass()\n}\n","function parseHexColor(color) {\n  // Check the string for incorrect formatting.\n  if (!color || color[0] !== '#') {\n    if (\n      color &&\n      typeof color.isKindOfClass === 'function' &&\n      color.isKindOfClass(NSColor)\n    ) {\n      return color\n    }\n    throw new Error(\n      'Incorrect color formating. It should be an hex color: #RRGGBBAA'\n    )\n  }\n\n  // append FF if alpha channel is not specified.\n  var source = color.substr(1)\n  if (source.length === 3) {\n    source += 'F'\n  } else if (source.length === 6) {\n    source += 'FF'\n  }\n  // Convert the string from #FFF format to #FFFFFF format.\n  var hex\n  if (source.length === 4) {\n    for (var i = 0; i < 4; i += 1) {\n      hex += source[i]\n      hex += source[i]\n    }\n  } else if (source.length === 8) {\n    hex = source\n  } else {\n    return NSColor.whiteColor()\n  }\n\n  var r = parseInt(hex.slice(0, 2), 16) / 255\n  var g = parseInt(hex.slice(2, 4), 16) / 255\n  var b = parseInt(hex.slice(4, 6), 16) / 255\n  var a = parseInt(hex.slice(6, 8), 16) / 255\n\n  return NSColor.colorWithSRGBRed_green_blue_alpha(r, g, b, a)\n}\n\nmodule.exports = function (browserWindow, panel, webview) {\n  // keep reference to the subviews\n  browserWindow._panel = panel\n  browserWindow._webview = webview\n  browserWindow._destroyed = false\n\n  browserWindow.destroy = function () {\n    return panel.close()\n  }\n\n  browserWindow.close = function () {\n    if (panel.delegate().utils && panel.delegate().utils.parentWindow) {\n      var shouldClose = true\n      browserWindow.emit('close', {\n        get defaultPrevented() {\n          return !shouldClose\n        },\n        preventDefault: function () {\n          shouldClose = false\n        },\n      })\n      if (shouldClose) {\n        panel.delegate().utils.parentWindow.endSheet(panel)\n      }\n      return\n    }\n\n    if (!browserWindow.isClosable()) {\n      return\n    }\n\n    panel.performClose(null)\n  }\n\n  function focus(focused) {\n    if (!browserWindow.isVisible()) {\n      return\n    }\n    if (focused) {\n      NSApplication.sharedApplication().activateIgnoringOtherApps(true)\n      panel.makeKeyAndOrderFront(null)\n    } else {\n      panel.orderBack(null)\n      NSApp.mainWindow().makeKeyAndOrderFront(null)\n    }\n  }\n\n  browserWindow.focus = focus.bind(this, true)\n  browserWindow.blur = focus.bind(this, false)\n\n  browserWindow.isFocused = function () {\n    return panel.isKeyWindow()\n  }\n\n  browserWindow.isDestroyed = function () {\n    return browserWindow._destroyed\n  }\n\n  browserWindow.show = function () {\n    // This method is supposed to put focus on window, however if the app does not\n    // have focus then \"makeKeyAndOrderFront\" will only show the window.\n    NSApp.activateIgnoringOtherApps(true)\n\n    if (panel.delegate().utils && panel.delegate().utils.parentWindow) {\n      return panel.delegate().utils.parentWindow.beginSheet_completionHandler(\n        panel,\n        __mocha__.createBlock_function('v16@?0q8', function () {\n          browserWindow.emit('closed')\n        })\n      )\n    }\n\n    return panel.makeKeyAndOrderFront(null)\n  }\n\n  browserWindow.showInactive = function () {\n    return panel.orderFrontRegardless()\n  }\n\n  browserWindow.hide = function () {\n    return panel.orderOut(null)\n  }\n\n  browserWindow.isVisible = function () {\n    return panel.isVisible()\n  }\n\n  browserWindow.isModal = function () {\n    return false\n  }\n\n  browserWindow.maximize = function () {\n    if (!browserWindow.isMaximized()) {\n      panel.zoom(null)\n    }\n  }\n  browserWindow.unmaximize = function () {\n    if (browserWindow.isMaximized()) {\n      panel.zoom(null)\n    }\n  }\n\n  browserWindow.isMaximized = function () {\n    if ((panel.styleMask() & NSResizableWindowMask) !== 0) {\n      return panel.isZoomed()\n    }\n    var rectScreen = NSScreen.mainScreen().visibleFrame()\n    var rectWindow = panel.frame()\n    return (\n      rectScreen.origin.x == rectWindow.origin.x &&\n      rectScreen.origin.y == rectWindow.origin.y &&\n      rectScreen.size.width == rectWindow.size.width &&\n      rectScreen.size.height == rectWindow.size.height\n    )\n  }\n\n  browserWindow.minimize = function () {\n    return panel.miniaturize(null)\n  }\n\n  browserWindow.restore = function () {\n    return panel.deminiaturize(null)\n  }\n\n  browserWindow.isMinimized = function () {\n    return panel.isMiniaturized()\n  }\n\n  browserWindow.setFullScreen = function (fullscreen) {\n    if (fullscreen !== browserWindow.isFullscreen()) {\n      panel.toggleFullScreen(null)\n    }\n  }\n\n  browserWindow.isFullscreen = function () {\n    return panel.styleMask() & NSFullScreenWindowMask\n  }\n\n  browserWindow.setAspectRatio = function (aspectRatio /* , extraSize */) {\n    // Reset the behaviour to default if aspect_ratio is set to 0 or less.\n    if (aspectRatio > 0.0) {\n      panel.setAspectRatio(NSMakeSize(aspectRatio, 1.0))\n    } else {\n      panel.setResizeIncrements(NSMakeSize(1.0, 1.0))\n    }\n  }\n\n  browserWindow.setBounds = function (bounds, animate) {\n    if (!bounds) {\n      return\n    }\n\n    // Do nothing if in fullscreen mode.\n    if (browserWindow.isFullscreen()) {\n      return\n    }\n\n    const newBounds = Object.assign(browserWindow.getBounds(), bounds)\n\n    // TODO: Check size constraints since setFrame does not check it.\n    // var size = bounds.size\n    // size.SetToMax(GetMinimumSize());\n    // gfx::Size max_size = GetMaximumSize();\n    // if (!max_size.IsEmpty())\n    //   size.SetToMin(max_size);\n\n    var cocoaBounds = NSMakeRect(\n      newBounds.x,\n      0,\n      newBounds.width,\n      newBounds.height\n    )\n    // Flip Y coordinates based on the primary screen\n    var screen = NSScreen.screens().firstObject()\n    cocoaBounds.origin.y = NSHeight(screen.frame()) - newBounds.y\n\n    panel.setFrame_display_animate(cocoaBounds, true, animate)\n  }\n\n  browserWindow.getBounds = function () {\n    const cocoaBounds = panel.frame()\n    var mainScreenRect = NSScreen.screens().firstObject().frame()\n    return {\n      x: cocoaBounds.origin.x,\n      y: Math.round(NSHeight(mainScreenRect) - cocoaBounds.origin.y),\n      width: cocoaBounds.size.width,\n      height: cocoaBounds.size.height,\n    }\n  }\n\n  browserWindow.setContentBounds = function (bounds, animate) {\n    // TODO:\n    browserWindow.setBounds(bounds, animate)\n  }\n\n  browserWindow.getContentBounds = function () {\n    // TODO:\n    return browserWindow.getBounds()\n  }\n\n  browserWindow.setSize = function (width, height, animate) {\n    // TODO: handle resizing around center\n    return browserWindow.setBounds({ width: width, height: height }, animate)\n  }\n\n  browserWindow.getSize = function () {\n    var bounds = browserWindow.getBounds()\n    return [bounds.width, bounds.height]\n  }\n\n  browserWindow.setContentSize = function (width, height, animate) {\n    // TODO: handle resizing around center\n    return browserWindow.setContentBounds(\n      { width: width, height: height },\n      animate\n    )\n  }\n\n  browserWindow.getContentSize = function () {\n    var bounds = browserWindow.getContentBounds()\n    return [bounds.width, bounds.height]\n  }\n\n  browserWindow.setMinimumSize = function (width, height) {\n    const minSize = CGSizeMake(width, height)\n    panel.setContentMinSize(minSize)\n  }\n\n  browserWindow.getMinimumSize = function () {\n    const size = panel.contentMinSize()\n    return [size.width, size.height]\n  }\n\n  browserWindow.setMaximumSize = function (width, height) {\n    const maxSize = CGSizeMake(width, height)\n    panel.setContentMaxSize(maxSize)\n  }\n\n  browserWindow.getMaximumSize = function () {\n    const size = panel.contentMaxSize()\n    return [size.width, size.height]\n  }\n\n  browserWindow.setResizable = function (resizable) {\n    return browserWindow._setStyleMask(resizable, NSResizableWindowMask)\n  }\n\n  browserWindow.isResizable = function () {\n    return panel.styleMask() & NSResizableWindowMask\n  }\n\n  browserWindow.setMovable = function (movable) {\n    return panel.setMovable(movable)\n  }\n  browserWindow.isMovable = function () {\n    return panel.isMovable()\n  }\n\n  browserWindow.setMinimizable = function (minimizable) {\n    return browserWindow._setStyleMask(minimizable, NSMiniaturizableWindowMask)\n  }\n\n  browserWindow.isMinimizable = function () {\n    return panel.styleMask() & NSMiniaturizableWindowMask\n  }\n\n  browserWindow.setMaximizable = function (maximizable) {\n    if (panel.standardWindowButton(NSWindowZoomButton)) {\n      panel.standardWindowButton(NSWindowZoomButton).setEnabled(maximizable)\n    }\n  }\n\n  browserWindow.isMaximizable = function () {\n    return (\n      panel.standardWindowButton(NSWindowZoomButton) &&\n      panel.standardWindowButton(NSWindowZoomButton).isEnabled()\n    )\n  }\n\n  browserWindow.setFullScreenable = function (fullscreenable) {\n    browserWindow._setCollectionBehavior(\n      fullscreenable,\n      NSWindowCollectionBehaviorFullScreenPrimary\n    )\n    // On EL Capitan this flag is required to hide fullscreen button.\n    browserWindow._setCollectionBehavior(\n      !fullscreenable,\n      NSWindowCollectionBehaviorFullScreenAuxiliary\n    )\n  }\n\n  browserWindow.isFullScreenable = function () {\n    var collectionBehavior = panel.collectionBehavior()\n    return collectionBehavior & NSWindowCollectionBehaviorFullScreenPrimary\n  }\n\n  browserWindow.setClosable = function (closable) {\n    browserWindow._setStyleMask(closable, NSClosableWindowMask)\n  }\n\n  browserWindow.isClosable = function () {\n    return panel.styleMask() & NSClosableWindowMask\n  }\n\n  browserWindow.setAlwaysOnTop = function (top, level, relativeLevel) {\n    var windowLevel = NSNormalWindowLevel\n    var maxWindowLevel = CGWindowLevelForKey(kCGMaximumWindowLevelKey)\n    var minWindowLevel = CGWindowLevelForKey(kCGMinimumWindowLevelKey)\n\n    if (top) {\n      if (level === 'normal') {\n        windowLevel = NSNormalWindowLevel\n      } else if (level === 'torn-off-menu') {\n        windowLevel = NSTornOffMenuWindowLevel\n      } else if (level === 'modal-panel') {\n        windowLevel = NSModalPanelWindowLevel\n      } else if (level === 'main-menu') {\n        windowLevel = NSMainMenuWindowLevel\n      } else if (level === 'status') {\n        windowLevel = NSStatusWindowLevel\n      } else if (level === 'pop-up-menu') {\n        windowLevel = NSPopUpMenuWindowLevel\n      } else if (level === 'screen-saver') {\n        windowLevel = NSScreenSaverWindowLevel\n      } else if (level === 'dock') {\n        // Deprecated by macOS, but kept for backwards compatibility\n        windowLevel = NSDockWindowLevel\n      } else {\n        windowLevel = NSFloatingWindowLevel\n      }\n    }\n\n    var newLevel = windowLevel + (relativeLevel || 0)\n    if (newLevel >= minWindowLevel && newLevel <= maxWindowLevel) {\n      panel.setLevel(newLevel)\n    } else {\n      throw new Error(\n        'relativeLevel must be between ' +\n          minWindowLevel +\n          ' and ' +\n          maxWindowLevel\n      )\n    }\n  }\n\n  browserWindow.isAlwaysOnTop = function () {\n    return panel.level() !== NSNormalWindowLevel\n  }\n\n  browserWindow.moveTop = function () {\n    return panel.orderFrontRegardless()\n  }\n\n  browserWindow.center = function () {\n    panel.center()\n  }\n\n  browserWindow.setPosition = function (x, y, animate) {\n    return browserWindow.setBounds({ x: x, y: y }, animate)\n  }\n\n  browserWindow.getPosition = function () {\n    var bounds = browserWindow.getBounds()\n    return [bounds.x, bounds.y]\n  }\n\n  browserWindow.setTitle = function (title) {\n    panel.setTitle(title)\n  }\n\n  browserWindow.getTitle = function () {\n    return String(panel.title())\n  }\n\n  var attentionRequestId = 0\n  browserWindow.flashFrame = function (flash) {\n    if (flash) {\n      attentionRequestId = NSApp.requestUserAttention(NSInformationalRequest)\n    } else {\n      NSApp.cancelUserAttentionRequest(attentionRequestId)\n      attentionRequestId = 0\n    }\n  }\n\n  browserWindow.getNativeWindowHandle = function () {\n    return panel\n  }\n\n  browserWindow.getNativeWebViewHandle = function () {\n    return webview\n  }\n\n  browserWindow.loadURL = function (url) {\n    // When frameLocation is a file, prefix it with the Sketch Resources path\n    if (/^(?!https?|file).*\\.html?$/.test(url)) {\n      if (typeof __command !== 'undefined' && __command.pluginBundle()) {\n        url =\n          'file://' + __command.pluginBundle().urlForResourceNamed(url).path()\n      }\n    }\n\n    if (/^file:\\/\\/.*\\.html?$/.test(url)) {\n      // ensure URLs containing spaces are properly handled\n      url = NSString.alloc().initWithString(url)\n      url = url.stringByAddingPercentEncodingWithAllowedCharacters(\n        NSCharacterSet.URLQueryAllowedCharacterSet()\n      )\n      webview.loadFileURL_allowingReadAccessToURL(\n        NSURL.URLWithString(url),\n        NSURL.URLWithString('file:///')\n      )\n      return\n    }\n\n    const properURL = NSURL.URLWithString(url)\n    const urlRequest = NSURLRequest.requestWithURL(properURL)\n\n    webview.loadRequest(urlRequest)\n  }\n\n  browserWindow.reload = function () {\n    webview.reload()\n  }\n\n  browserWindow.setHasShadow = function (hasShadow) {\n    return panel.setHasShadow(hasShadow)\n  }\n\n  browserWindow.hasShadow = function () {\n    return panel.hasShadow()\n  }\n\n  browserWindow.setOpacity = function (opacity) {\n    return panel.setAlphaValue(opacity)\n  }\n\n  browserWindow.getOpacity = function () {\n    return panel.alphaValue()\n  }\n\n  browserWindow.setVisibleOnAllWorkspaces = function (visible) {\n    return browserWindow._setCollectionBehavior(\n      visible,\n      NSWindowCollectionBehaviorCanJoinAllSpaces\n    )\n  }\n\n  browserWindow.isVisibleOnAllWorkspaces = function () {\n    var collectionBehavior = panel.collectionBehavior()\n    return collectionBehavior & NSWindowCollectionBehaviorCanJoinAllSpaces\n  }\n\n  browserWindow.setIgnoreMouseEvents = function (ignore) {\n    return panel.setIgnoresMouseEvents(ignore)\n  }\n\n  browserWindow.setContentProtection = function (enable) {\n    panel.setSharingType(enable ? NSWindowSharingNone : NSWindowSharingReadOnly)\n  }\n\n  browserWindow.setAutoHideCursor = function (autoHide) {\n    panel.setDisableAutoHideCursor(autoHide)\n  }\n\n  browserWindow.setVibrancy = function (type) {\n    var effectView = browserWindow._vibrantView\n\n    if (!type) {\n      if (effectView == null) {\n        return\n      }\n\n      effectView.removeFromSuperview()\n      panel.setVibrantView(null)\n      return\n    }\n\n    if (effectView == null) {\n      var contentView = panel.contentView()\n      effectView = NSVisualEffectView.alloc().initWithFrame(\n        contentView.bounds()\n      )\n      browserWindow._vibrantView = effectView\n\n      effectView.setAutoresizingMask(NSViewWidthSizable | NSViewHeightSizable)\n      effectView.setBlendingMode(NSVisualEffectBlendingModeBehindWindow)\n      effectView.setState(NSVisualEffectStateActive)\n      effectView.setFrame(contentView.bounds())\n      contentView.addSubview_positioned_relativeTo(\n        effectView,\n        NSWindowBelow,\n        null\n      )\n    }\n\n    var vibrancyType = NSVisualEffectMaterialLight\n\n    if (type === 'appearance-based') {\n      vibrancyType = NSVisualEffectMaterialAppearanceBased\n    } else if (type === 'light') {\n      vibrancyType = NSVisualEffectMaterialLight\n    } else if (type === 'dark') {\n      vibrancyType = NSVisualEffectMaterialDark\n    } else if (type === 'titlebar') {\n      vibrancyType = NSVisualEffectMaterialTitlebar\n    } else if (type === 'selection') {\n      vibrancyType = NSVisualEffectMaterialSelection\n    } else if (type === 'menu') {\n      vibrancyType = NSVisualEffectMaterialMenu\n    } else if (type === 'popover') {\n      vibrancyType = NSVisualEffectMaterialPopover\n    } else if (type === 'sidebar') {\n      vibrancyType = NSVisualEffectMaterialSidebar\n    } else if (type === 'medium-light') {\n      vibrancyType = NSVisualEffectMaterialMediumLight\n    } else if (type === 'ultra-dark') {\n      vibrancyType = NSVisualEffectMaterialUltraDark\n    }\n\n    effectView.setMaterial(vibrancyType)\n  }\n\n  browserWindow._setBackgroundColor = function (colorName) {\n    var color = parseHexColor(colorName)\n    webview.setValue_forKey(false, 'drawsBackground')\n    panel.backgroundColor = color\n  }\n\n  browserWindow._invalidate = function () {\n    panel.flushWindow()\n    panel.contentView().setNeedsDisplay(true)\n  }\n\n  browserWindow._setStyleMask = function (on, flag) {\n    var wasMaximizable = browserWindow.isMaximizable()\n    if (on) {\n      panel.setStyleMask(panel.styleMask() | flag)\n    } else {\n      panel.setStyleMask(panel.styleMask() & ~flag)\n    }\n    // Change style mask will make the zoom button revert to default, probably\n    // a bug of Cocoa or macOS.\n    browserWindow.setMaximizable(wasMaximizable)\n  }\n\n  browserWindow._setCollectionBehavior = function (on, flag) {\n    var wasMaximizable = browserWindow.isMaximizable()\n    if (on) {\n      panel.setCollectionBehavior(panel.collectionBehavior() | flag)\n    } else {\n      panel.setCollectionBehavior(panel.collectionBehavior() & ~flag)\n    }\n    // Change collectionBehavior will make the zoom button revert to default,\n    // probably a bug of Cocoa or macOS.\n    browserWindow.setMaximizable(wasMaximizable)\n  }\n\n  browserWindow._showWindowButton = function (button) {\n    var view = panel.standardWindowButton(button)\n    view.superview().addSubview_positioned_relative(view, NSWindowAbove, null)\n  }\n}\n","module.exports = {\n  JS_BRIDGE: '__skpm_sketchBridge',\n  JS_BRIDGE_RESULT_SUCCESS: '__skpm_sketchBridge_success',\n  JS_BRIDGE_RESULT_ERROR: '__skpm_sketchBridge_error',\n  START_MOVING_WINDOW: '__skpm_startMovingWindow',\n  EXECUTE_JAVASCRIPT: '__skpm_executeJS',\n  EXECUTE_JAVASCRIPT_SUCCESS: '__skpm_executeJS_success_',\n  EXECUTE_JAVASCRIPT_ERROR: '__skpm_executeJS_error_',\n}\n","var tagsToFocus =\n  '[\"text\", \"textarea\", \"date\", \"datetime-local\", \"email\", \"number\", \"month\", \"password\", \"search\", \"tel\", \"time\", \"url\", \"week\" ]'\n\nmodule.exports = function (webView, event) {\n  var point = webView.convertPoint_fromView(event.locationInWindow(), null)\n  return (\n    'var el = document.elementFromPoint(' + // get the DOM element that match the event\n    point.x +\n    ', ' +\n    point.y +\n    '); ' +\n    'if (el && el.tagName === \"SELECT\") {' + // select needs special handling\n    '  var event = document.createEvent(\"MouseEvents\");' +\n    '  event.initMouseEvent(\"mousedown\", true, true, window);' +\n    '  el.dispatchEvent(event);' +\n    '} else if (el && ' + // some tags need to be focused instead of clicked\n    tagsToFocus +\n    '.indexOf(el.type) >= 0 && ' +\n    'el.focus' +\n    ') {' +\n    'el.focus();' + // so focus them\n    '} else if (el) {' +\n    'el.dispatchEvent(new Event(\"click\", {bubbles: true}))' + // click the others\n    '}'\n  )\n}\n","var CONSTANTS = require('./constants')\n\nmodule.exports = function (webview, browserWindow) {\n  function executeJavaScript(script, userGesture, callback) {\n    if (typeof userGesture === 'function') {\n      callback = userGesture\n      userGesture = false\n    }\n    var fiber = coscript.createFiber()\n\n    // if the webview is not ready yet, defer the execution until it is\n    if (\n      webview.navigationDelegate().state &&\n      webview.navigationDelegate().state.wasReady == 0\n    ) {\n      return new Promise(function (resolve, reject) {\n        browserWindow.once('ready-to-show', function () {\n          executeJavaScript(script, userGesture, callback)\n            .then(resolve)\n            .catch(reject)\n          fiber.cleanup()\n        })\n      })\n    }\n\n    return new Promise(function (resolve, reject) {\n      var requestId = Math.random()\n\n      browserWindow.webContents.on(\n        CONSTANTS.EXECUTE_JAVASCRIPT_SUCCESS + requestId,\n        function (res) {\n          try {\n            if (callback) {\n              callback(null, res)\n            }\n            resolve(res)\n          } catch (err) {\n            reject(err)\n          }\n          fiber.cleanup()\n        }\n      )\n      browserWindow.webContents.on(\n        CONSTANTS.EXECUTE_JAVASCRIPT_ERROR + requestId,\n        function (err) {\n          try {\n            if (callback) {\n              callback(err)\n              resolve()\n            } else {\n              reject(err)\n            }\n          } catch (err2) {\n            reject(err2)\n          }\n          fiber.cleanup()\n        }\n      )\n\n      webview.evaluateJavaScript_completionHandler(\n        module.exports.wrapScript(script, requestId),\n        null\n      )\n    })\n  }\n\n  return executeJavaScript\n}\n\nmodule.exports.wrapScript = function (script, requestId) {\n  return (\n    'window.' +\n    CONSTANTS.EXECUTE_JAVASCRIPT +\n    '(' +\n    requestId +\n    ', ' +\n    JSON.stringify(script) +\n    ')'\n  )\n}\n\nmodule.exports.injectScript = function (webView) {\n  var source =\n    'window.' +\n    CONSTANTS.EXECUTE_JAVASCRIPT +\n    ' = function(id, script) {' +\n    '  try {' +\n    '    var res = eval(script);' +\n    '    if (res && typeof res.then === \"function\" && typeof res.catch === \"function\") {' +\n    '      res.then(function (res2) {' +\n    '        window.postMessage(\"' +\n    CONSTANTS.EXECUTE_JAVASCRIPT_SUCCESS +\n    '\" + id, res2);' +\n    '      })' +\n    '      .catch(function (err) {' +\n    '        window.postMessage(\"' +\n    CONSTANTS.EXECUTE_JAVASCRIPT_ERROR +\n    '\" + id, err);' +\n    '      })' +\n    '    } else {' +\n    '      window.postMessage(\"' +\n    CONSTANTS.EXECUTE_JAVASCRIPT_SUCCESS +\n    '\" + id, res);' +\n    '    }' +\n    '  } catch (err) {' +\n    '    window.postMessage(\"' +\n    CONSTANTS.EXECUTE_JAVASCRIPT_ERROR +\n    '\" + id, err);' +\n    '  }' +\n    '}'\n  var script = WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(\n    source,\n    0,\n    true\n  )\n  webView.configuration().userContentController().addUserScript(script)\n}\n","function addEdgeConstraint(edge, subview, view, constant) {\n  view.addConstraint(\n    NSLayoutConstraint.constraintWithItem_attribute_relatedBy_toItem_attribute_multiplier_constant(\n      subview,\n      edge,\n      NSLayoutRelationEqual,\n      view,\n      edge,\n      1,\n      constant\n    )\n  )\n}\nmodule.exports = function fitSubviewToView(subview, view, constants) {\n  constants = constants || []\n  subview.setTranslatesAutoresizingMaskIntoConstraints(false)\n\n  addEdgeConstraint(NSLayoutAttributeLeft, subview, view, constants[0] || 0)\n  addEdgeConstraint(NSLayoutAttributeTop, subview, view, constants[1] || 0)\n  addEdgeConstraint(NSLayoutAttributeRight, subview, view, constants[2] || 0)\n  addEdgeConstraint(NSLayoutAttributeBottom, subview, view, constants[3] || 0)\n}\n","/* let's try to match the API from Electron's Browser window\n(https://github.com/electron/electron/blob/master/docs/api/browser-window.md) */\nvar EventEmitter = require('events')\nvar buildBrowserAPI = require('./browser-api')\nvar buildWebAPI = require('./webview-api')\nvar fitSubviewToView = require('./fitSubview')\nvar dispatchFirstClick = require('./dispatch-first-click')\nvar injectClientMessaging = require('./inject-client-messaging')\nvar movableArea = require('./movable-area')\nvar executeJavaScript = require('./execute-javascript')\nvar setDelegates = require('./set-delegates')\n\nfunction BrowserWindow(options) {\n  options = options || {}\n\n  var identifier = options.identifier || String(NSUUID.UUID().UUIDString())\n  var threadDictionary = NSThread.mainThread().threadDictionary()\n\n  var existingBrowserWindow = BrowserWindow.fromId(identifier)\n\n  // if we already have a window opened, reuse it\n  if (existingBrowserWindow) {\n    return existingBrowserWindow\n  }\n\n  var browserWindow = new EventEmitter()\n  browserWindow.id = identifier\n\n  if (options.modal && !options.parent) {\n    throw new Error('A modal needs to have a parent.')\n  }\n\n  // Long-running script\n  var fiber = coscript.createFiber()\n\n  // Window size\n  var width = options.width || 800\n  var height = options.height || 600\n  var mainScreenRect = NSScreen.screens().firstObject().frame()\n  var cocoaBounds = NSMakeRect(\n    typeof options.x !== 'undefined'\n      ? options.x\n      : Math.round((NSWidth(mainScreenRect) - width) / 2),\n    typeof options.y !== 'undefined'\n      ? NSHeight(mainScreenRect) - options.y\n      : Math.round((NSHeight(mainScreenRect) - height) / 2),\n    width,\n    height\n  )\n\n  if (options.titleBarStyle && options.titleBarStyle !== 'default') {\n    options.frame = false\n  }\n\n  var useStandardWindow = options.windowType !== 'textured'\n  var styleMask = NSTitledWindowMask\n\n  // this is commented out because the toolbar doesn't appear otherwise :thinking-face:\n  // if (!useStandardWindow || options.frame === false) {\n  //   styleMask = NSFullSizeContentViewWindowMask\n  // }\n  if (options.minimizable !== false) {\n    styleMask |= NSMiniaturizableWindowMask\n  }\n  if (options.closable !== false) {\n    styleMask |= NSClosableWindowMask\n  }\n  if (options.resizable !== false) {\n    styleMask |= NSResizableWindowMask\n  }\n  if (!useStandardWindow || options.transparent || options.frame === false) {\n    styleMask |= NSTexturedBackgroundWindowMask\n  }\n\n  var panel = NSPanel.alloc().initWithContentRect_styleMask_backing_defer(\n    cocoaBounds,\n    styleMask,\n    NSBackingStoreBuffered,\n    true\n  )\n\n  // this would be nice but it's crashing on macOS 11.0\n  // panel.releasedWhenClosed = true\n\n  var wkwebviewConfig = WKWebViewConfiguration.alloc().init()\n  var webView = WKWebView.alloc().initWithFrame_configuration(\n    CGRectMake(0, 0, options.width || 800, options.height || 600),\n    wkwebviewConfig\n  )\n  injectClientMessaging(webView)\n  webView.setAutoresizingMask(NSViewWidthSizable | NSViewHeightSizable)\n\n  buildBrowserAPI(browserWindow, panel, webView)\n  buildWebAPI(browserWindow, panel, webView)\n  setDelegates(browserWindow, panel, webView, options)\n\n  if (options.windowType === 'desktop') {\n    panel.setLevel(kCGDesktopWindowLevel - 1)\n    // panel.setCanBecomeKeyWindow(false)\n    panel.setCollectionBehavior(\n      NSWindowCollectionBehaviorCanJoinAllSpaces |\n        NSWindowCollectionBehaviorStationary |\n        NSWindowCollectionBehaviorIgnoresCycle\n    )\n  }\n\n  if (\n    typeof options.minWidth !== 'undefined' ||\n    typeof options.minHeight !== 'undefined'\n  ) {\n    browserWindow.setMinimumSize(options.minWidth || 0, options.minHeight || 0)\n  }\n\n  if (\n    typeof options.maxWidth !== 'undefined' ||\n    typeof options.maxHeight !== 'undefined'\n  ) {\n    browserWindow.setMaximumSize(\n      options.maxWidth || 10000,\n      options.maxHeight || 10000\n    )\n  }\n\n  // if (options.focusable === false) {\n  //   panel.setCanBecomeKeyWindow(false)\n  // }\n\n  if (options.transparent || options.frame === false) {\n    panel.titlebarAppearsTransparent = true\n    panel.titleVisibility = NSWindowTitleHidden\n    panel.setOpaque(0)\n    panel.isMovableByWindowBackground = true\n    var toolbar2 = NSToolbar.alloc().initWithIdentifier(\n      'titlebarStylingToolbar'\n    )\n    toolbar2.setShowsBaselineSeparator(false)\n    panel.setToolbar(toolbar2)\n  }\n\n  if (options.titleBarStyle === 'hiddenInset') {\n    var toolbar = NSToolbar.alloc().initWithIdentifier('titlebarStylingToolbar')\n    toolbar.setShowsBaselineSeparator(false)\n    panel.setToolbar(toolbar)\n  }\n\n  if (options.frame === false || !options.useContentSize) {\n    browserWindow.setSize(width, height)\n  }\n\n  if (options.center) {\n    browserWindow.center()\n  }\n\n  if (options.alwaysOnTop) {\n    browserWindow.setAlwaysOnTop(true)\n  }\n\n  if (options.fullscreen) {\n    browserWindow.setFullScreen(true)\n  }\n  browserWindow.setFullScreenable(!!options.fullscreenable)\n\n  let title = options.title\n  if (options.frame === false) {\n    title = undefined\n  } else if (\n    typeof title === 'undefined' &&\n    typeof __command !== 'undefined' &&\n    __command.pluginBundle()\n  ) {\n    title = __command.pluginBundle().name()\n  }\n\n  if (title) {\n    browserWindow.setTitle(title)\n  }\n\n  var backgroundColor = options.backgroundColor\n  if (options.transparent) {\n    backgroundColor = NSColor.clearColor()\n  }\n  if (!backgroundColor && options.frame === false && options.vibrancy) {\n    backgroundColor = NSColor.clearColor()\n  }\n\n  browserWindow._setBackgroundColor(\n    backgroundColor || NSColor.windowBackgroundColor()\n  )\n\n  if (options.hasShadow === false) {\n    browserWindow.setHasShadow(false)\n  }\n\n  if (typeof options.opacity !== 'undefined') {\n    browserWindow.setOpacity(options.opacity)\n  }\n\n  options.webPreferences = options.webPreferences || {}\n\n  webView\n    .configuration()\n    .preferences()\n    .setValue_forKey(\n      options.webPreferences.devTools !== false,\n      'developerExtrasEnabled'\n    )\n  webView\n    .configuration()\n    .preferences()\n    .setValue_forKey(\n      options.webPreferences.javascript !== false,\n      'javaScriptEnabled'\n    )\n  webView\n    .configuration()\n    .preferences()\n    .setValue_forKey(!!options.webPreferences.plugins, 'plugInsEnabled')\n  webView\n    .configuration()\n    .preferences()\n    .setValue_forKey(\n      options.webPreferences.minimumFontSize || 0,\n      'minimumFontSize'\n    )\n\n  if (options.webPreferences.zoomFactor) {\n    webView.setMagnification(options.webPreferences.zoomFactor)\n  }\n\n  var contentView = panel.contentView()\n\n  if (options.frame !== false) {\n    webView.setFrame(contentView.bounds())\n    contentView.addSubview(webView)\n  } else {\n    // In OSX 10.10, adding subviews to the root view for the NSView hierarchy\n    // produces warnings. To eliminate the warnings, we resize the contentView\n    // to fill the window, and add subviews to that.\n    // http://crbug.com/380412\n    contentView.setAutoresizingMask(NSViewWidthSizable | NSViewHeightSizable)\n    fitSubviewToView(contentView, contentView.superview())\n\n    webView.setFrame(contentView.bounds())\n    contentView.addSubview(webView)\n\n    // The fullscreen button should always be hidden for frameless window.\n    if (panel.standardWindowButton(NSWindowFullScreenButton)) {\n      panel.standardWindowButton(NSWindowFullScreenButton).setHidden(true)\n    }\n\n    if (!options.titleBarStyle || options.titleBarStyle === 'default') {\n      // Hide the window buttons.\n      panel.standardWindowButton(NSWindowZoomButton).setHidden(true)\n      panel.standardWindowButton(NSWindowMiniaturizeButton).setHidden(true)\n      panel.standardWindowButton(NSWindowCloseButton).setHidden(true)\n\n      // Some third-party macOS utilities check the zoom button's enabled state to\n      // determine whether to show custom UI on hover, so we disable it here to\n      // prevent them from doing so in a frameless app window.\n      panel.standardWindowButton(NSWindowZoomButton).setEnabled(false)\n    }\n  }\n\n  if (options.vibrancy) {\n    browserWindow.setVibrancy(options.vibrancy)\n  }\n\n  // Set maximizable state last to ensure zoom button does not get reset\n  // by calls to other APIs.\n  browserWindow.setMaximizable(options.maximizable !== false)\n\n  panel.setHidesOnDeactivate(options.hidesOnDeactivate !== false)\n\n  if (options.remembersWindowFrame) {\n    panel.setFrameAutosaveName(identifier)\n    panel.setFrameUsingName_force(panel.frameAutosaveName(), false)\n  }\n\n  if (options.acceptsFirstMouse) {\n    browserWindow.on('focus', function (event) {\n      if (event.type() === NSEventTypeLeftMouseDown) {\n        browserWindow.webContents\n          .executeJavaScript(dispatchFirstClick(webView, event))\n          .catch(() => {})\n      }\n    })\n  }\n\n  executeJavaScript.injectScript(webView)\n  movableArea.injectScript(webView)\n  movableArea.setupHandler(browserWindow)\n\n  if (options.show !== false) {\n    browserWindow.show()\n  }\n\n  browserWindow.on('closed', function () {\n    browserWindow._destroyed = true\n    threadDictionary.removeObjectForKey(identifier)\n    var observer = threadDictionary[identifier + '.themeObserver']\n    if (observer) {\n      NSApplication.sharedApplication().removeObserver_forKeyPath(\n        observer,\n        'effectiveAppearance'\n      )\n      threadDictionary.removeObjectForKey(identifier + '.themeObserver')\n    }\n    fiber.cleanup()\n  })\n\n  threadDictionary[identifier] = panel\n\n  fiber.onCleanup(function () {\n    if (!browserWindow._destroyed) {\n      browserWindow.destroy()\n    }\n  })\n\n  return browserWindow\n}\n\nBrowserWindow.fromId = function (identifier) {\n  var threadDictionary = NSThread.mainThread().threadDictionary()\n\n  if (threadDictionary[identifier]) {\n    return BrowserWindow.fromPanel(threadDictionary[identifier], identifier)\n  }\n\n  return undefined\n}\n\nBrowserWindow.fromPanel = function (panel, identifier) {\n  var browserWindow = new EventEmitter()\n  browserWindow.id = identifier\n\n  if (!panel || !panel.contentView) {\n    throw new Error('needs to pass an NSPanel')\n  }\n\n  var webView = null\n  var subviews = panel.contentView().subviews()\n  for (var i = 0; i < subviews.length; i += 1) {\n    if (\n      !webView &&\n      !subviews[i].isKindOfClass(WKInspectorWKWebView) &&\n      subviews[i].isKindOfClass(WKWebView)\n    ) {\n      webView = subviews[i]\n    }\n  }\n\n  if (!webView) {\n    throw new Error('The panel needs to have a webview')\n  }\n\n  buildBrowserAPI(browserWindow, panel, webView)\n  buildWebAPI(browserWindow, panel, webView)\n\n  return browserWindow\n}\n\nmodule.exports = BrowserWindow\n","var CONSTANTS = require('./constants')\n\nmodule.exports = function (webView) {\n  var source =\n    'window.originalPostMessage = window.postMessage;' +\n    'window.postMessage = function(actionName) {' +\n    '  if (!actionName) {' +\n    \"    throw new Error('missing action name')\" +\n    '  }' +\n    '  var id = String(Math.random()).replace(\".\", \"\");' +\n    '    var args = [].slice.call(arguments);' +\n    '    args.unshift(id);' +\n    '  return new Promise(function (resolve, reject) {' +\n    '    window[\"' +\n    CONSTANTS.JS_BRIDGE_RESULT_SUCCESS +\n    '\" + id] = resolve;' +\n    '    window[\"' +\n    CONSTANTS.JS_BRIDGE_RESULT_ERROR +\n    '\" + id] = reject;' +\n    '    window.webkit.messageHandlers.' +\n    CONSTANTS.JS_BRIDGE +\n    '.postMessage(JSON.stringify(args));' +\n    '  });' +\n    '}'\n  var script = WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(\n    source,\n    0,\n    true\n  )\n  webView.configuration().userContentController().addUserScript(script)\n}\n","var CONSTANTS = require('./constants')\n\nmodule.exports.injectScript = function (webView) {\n  var source =\n    '(function () {' +\n    \"document.addEventListener('mousedown', onMouseDown);\" +\n    '' +\n    'function shouldDrag(target) {' +\n    '  if (!target || (target.dataset || {}).appRegion === \"no-drag\") { return false }' +\n    '  if ((target.dataset || {}).appRegion === \"drag\") { return true }' +\n    '  return shouldDrag(target.parentElement)' +\n    '};' +\n    '' +\n    'function onMouseDown(e) {' +\n    '  if (e.button !== 0 || !shouldDrag(e.target)) { return }' +\n    '  window.postMessage(\"' +\n    CONSTANTS.START_MOVING_WINDOW +\n    '\");' +\n    '};' +\n    '})()'\n  var script = WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(\n    source,\n    0,\n    true\n  )\n  webView.configuration().userContentController().addUserScript(script)\n}\n\nmodule.exports.setupHandler = function (browserWindow) {\n  var initialMouseLocation = null\n  var initialWindowPosition = null\n  var interval = null\n\n  function moveWindow() {\n    // if the user released the button, stop moving the window\n    if (!initialWindowPosition || NSEvent.pressedMouseButtons() !== 1) {\n      clearInterval(interval)\n      initialMouseLocation = null\n      initialWindowPosition = null\n      return\n    }\n\n    var mouse = NSEvent.mouseLocation()\n    browserWindow.setPosition(\n      initialWindowPosition.x + (mouse.x - initialMouseLocation.x),\n      initialWindowPosition.y + (initialMouseLocation.y - mouse.y), // y is inverted\n      false\n    )\n  }\n\n  browserWindow.webContents.on(CONSTANTS.START_MOVING_WINDOW, function () {\n    initialMouseLocation = NSEvent.mouseLocation()\n    var position = browserWindow.getPosition()\n    initialWindowPosition = {\n      x: position[0],\n      y: position[1],\n    }\n\n    interval = setInterval(moveWindow, 1000 / 60) // 60 fps\n  })\n}\n","module.exports = function (webArguments) {\n  var args = null\n  try {\n    args = JSON.parse(webArguments)\n  } catch (e) {\n    // malformed arguments\n  }\n\n  if (\n    !args ||\n    !args.constructor ||\n    args.constructor !== Array ||\n    args.length == 0\n  ) {\n    return null\n  }\n\n  return args\n}\n","var ObjCClass = require('mocha-js-delegate')\nvar parseWebArguments = require('./parseWebArguments')\nvar CONSTANTS = require('./constants')\n\n// We create one ObjC class for ourselves here\nvar WindowDelegateClass\nvar NavigationDelegateClass\nvar WebScriptHandlerClass\nvar ThemeObserverClass\n\n// TODO: events\n// - 'page-favicon-updated'\n// - 'new-window'\n// - 'did-navigate-in-page'\n// - 'will-prevent-unload'\n// - 'crashed'\n// - 'unresponsive'\n// - 'responsive'\n// - 'destroyed'\n// - 'before-input-event'\n// - 'certificate-error'\n// - 'found-in-page'\n// - 'media-started-playing'\n// - 'media-paused'\n// - 'did-change-theme-color'\n// - 'update-target-url'\n// - 'cursor-changed'\n// - 'context-menu'\n// - 'select-bluetooth-device'\n// - 'paint'\n// - 'console-message'\n\nmodule.exports = function (browserWindow, panel, webview, options) {\n  if (!ThemeObserverClass) {\n    ThemeObserverClass = new ObjCClass({\n      utils: null,\n\n      'observeValueForKeyPath:ofObject:change:context:': function (\n        keyPath,\n        object,\n        change\n      ) {\n        const newAppearance = change[NSKeyValueChangeNewKey]\n        const isDark =\n          String(\n            newAppearance.bestMatchFromAppearancesWithNames([\n              'NSAppearanceNameAqua',\n              'NSAppearanceNameDarkAqua',\n            ])\n          ) === 'NSAppearanceNameDarkAqua'\n\n        this.utils.executeJavaScript(\n          \"document.body.classList.remove('__skpm-\" +\n            (isDark ? 'light' : 'dark') +\n            \"'); document.body.classList.add('__skpm-\" +\n            (isDark ? 'dark' : 'light') +\n            \"')\"\n        )\n      },\n    })\n  }\n\n  if (!WindowDelegateClass) {\n    WindowDelegateClass = new ObjCClass({\n      utils: null,\n      panel: null,\n\n      'windowDidResize:': function () {\n        this.utils.emit('resize')\n      },\n\n      'windowDidMiniaturize:': function () {\n        this.utils.emit('minimize')\n      },\n\n      'windowDidDeminiaturize:': function () {\n        this.utils.emit('restore')\n      },\n\n      'windowDidEnterFullScreen:': function () {\n        this.utils.emit('enter-full-screen')\n      },\n\n      'windowDidExitFullScreen:': function () {\n        this.utils.emit('leave-full-screen')\n      },\n\n      'windowDidMove:': function () {\n        this.utils.emit('move')\n        this.utils.emit('moved')\n      },\n\n      'windowShouldClose:': function () {\n        var shouldClose = 1\n        this.utils.emit('close', {\n          get defaultPrevented() {\n            return !shouldClose\n          },\n          preventDefault: function () {\n            shouldClose = 0\n          },\n        })\n        return shouldClose\n      },\n\n      'windowWillClose:': function () {\n        this.utils.emit('closed')\n      },\n\n      'windowDidBecomeKey:': function () {\n        this.utils.emit('focus', this.panel.currentEvent())\n      },\n\n      'windowDidResignKey:': function () {\n        this.utils.emit('blur')\n      },\n    })\n  }\n\n  if (!NavigationDelegateClass) {\n    NavigationDelegateClass = new ObjCClass({\n      state: {\n        wasReady: 0,\n      },\n      utils: null,\n\n      // // Called when the web view begins to receive web content.\n      'webView:didCommitNavigation:': function (webView) {\n        this.utils.emit('will-navigate', {}, String(String(webView.URL())))\n      },\n\n      // // Called when web content begins to load in a web view.\n      'webView:didStartProvisionalNavigation:': function () {\n        this.utils.emit('did-start-navigation')\n        this.utils.emit('did-start-loading')\n      },\n\n      // Called when a web view receives a server redirect.\n      'webView:didReceiveServerRedirectForProvisionalNavigation:': function () {\n        this.utils.emit('did-get-redirect-request')\n      },\n\n      // // Called when the web view needs to respond to an authentication challenge.\n      // 'webView:didReceiveAuthenticationChallenge:completionHandler:': function(\n      //   webView,\n      //   challenge,\n      //   completionHandler\n      // ) {\n      //   function callback(username, password) {\n      //     completionHandler(\n      //       0,\n      //       NSURLCredential.credentialWithUser_password_persistence(\n      //         username,\n      //         password,\n      //         1\n      //       )\n      //     )\n      //   }\n      //   var protectionSpace = challenge.protectionSpace()\n      //   this.utils.emit(\n      //     'login',\n      //     {},\n      //     {\n      //       method: String(protectionSpace.authenticationMethod()),\n      //       url: 'not implemented', // TODO:\n      //       referrer: 'not implemented', // TODO:\n      //     },\n      //     {\n      //       isProxy: !!protectionSpace.isProxy(),\n      //       scheme: String(protectionSpace.protocol()),\n      //       host: String(protectionSpace.host()),\n      //       port: Number(protectionSpace.port()),\n      //       realm: String(protectionSpace.realm()),\n      //     },\n      //     callback\n      //   )\n      // },\n\n      // Called when an error occurs during navigation.\n      // 'webView:didFailNavigation:withError:': function(\n      //   webView,\n      //   navigation,\n      //   error\n      // ) {},\n\n      // Called when an error occurs while the web view is loading content.\n      'webView:didFailProvisionalNavigation:withError:': function (\n        webView,\n        navigation,\n        error\n      ) {\n        this.utils.emit('did-fail-load', error)\n      },\n\n      // Called when the navigation is complete.\n      'webView:didFinishNavigation:': function () {\n        if (this.state.wasReady == 0) {\n          this.state.wasReady = 1\n          this.utils.emitBrowserEvent('ready-to-show')\n        }\n        this.utils.emit('did-navigate')\n        this.utils.emit('did-frame-navigate')\n        this.utils.emit('did-stop-loading')\n        this.utils.emit('did-finish-load')\n        this.utils.emit('did-frame-finish-load')\n      },\n\n      // Called when the web view’s web content process is terminated.\n      'webViewWebContentProcessDidTerminate:': function () {\n        this.utils.emit('dom-ready')\n      },\n\n      // Decides whether to allow or cancel a navigation.\n      // webView:decidePolicyForNavigationAction:decisionHandler:\n\n      // Decides whether to allow or cancel a navigation after its response is known.\n      // webView:decidePolicyForNavigationResponse:decisionHandler:\n    })\n  }\n\n  if (!WebScriptHandlerClass) {\n    WebScriptHandlerClass = new ObjCClass({\n      utils: null,\n      'userContentController:didReceiveScriptMessage:': function (_, message) {\n        var args = this.utils.parseWebArguments(String(message.body()))\n        if (!args) {\n          return\n        }\n        if (!args[0] || typeof args[0] !== 'string') {\n          return\n        }\n        args[0] = String(args[0])\n\n        this.utils.emit.apply(this, args)\n      },\n    })\n  }\n\n  var themeObserver = ThemeObserverClass.new({\n    utils: {\n      executeJavaScript(script) {\n        webview.evaluateJavaScript_completionHandler(script, null)\n      },\n    },\n  })\n\n  var script = WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(\n    \"document.addEventListener('DOMContentLoaded', function() { document.body.classList.add('__skpm-\" +\n      (typeof MSTheme !== 'undefined' && MSTheme.sharedTheme().isDark()\n        ? 'dark'\n        : 'light') +\n      \"') }, false)\",\n    0,\n    true\n  )\n  webview.configuration().userContentController().addUserScript(script)\n\n  NSApplication.sharedApplication().addObserver_forKeyPath_options_context(\n    themeObserver,\n    'effectiveAppearance',\n    NSKeyValueObservingOptionNew,\n    null\n  )\n\n  var threadDictionary = NSThread.mainThread().threadDictionary()\n  threadDictionary[browserWindow.id + '.themeObserver'] = themeObserver\n\n  var navigationDelegate = NavigationDelegateClass.new({\n    utils: {\n      setTitle: browserWindow.setTitle.bind(browserWindow),\n      emitBrowserEvent() {\n        try {\n          browserWindow.emit.apply(browserWindow, arguments)\n        } catch (err) {\n          if (\n            typeof process !== 'undefined' &&\n            process.listenerCount &&\n            process.listenerCount('uncaughtException')\n          ) {\n            process.emit('uncaughtException', err, 'uncaughtException')\n          } else {\n            console.error(err)\n            throw err\n          }\n        }\n      },\n      emit() {\n        try {\n          browserWindow.webContents.emit.apply(\n            browserWindow.webContents,\n            arguments\n          )\n        } catch (err) {\n          if (\n            typeof process !== 'undefined' &&\n            process.listenerCount &&\n            process.listenerCount('uncaughtException')\n          ) {\n            process.emit('uncaughtException', err, 'uncaughtException')\n          } else {\n            console.error(err)\n            throw err\n          }\n        }\n      },\n    },\n    state: {\n      wasReady: 0,\n    },\n  })\n\n  webview.setNavigationDelegate(navigationDelegate)\n\n  var webScriptHandler = WebScriptHandlerClass.new({\n    utils: {\n      emit(id, type) {\n        if (!type) {\n          webview.evaluateJavaScript_completionHandler(\n            CONSTANTS.JS_BRIDGE_RESULT_SUCCESS + id + '()',\n            null\n          )\n          return\n        }\n\n        var args = []\n        for (var i = 2; i < arguments.length; i += 1) args.push(arguments[i])\n\n        var listeners = browserWindow.webContents.listeners(type)\n\n        Promise.all(\n          listeners.map(function (l) {\n            return Promise.resolve().then(function () {\n              return l.apply(l, args)\n            })\n          })\n        )\n          .then(function (res) {\n            webview.evaluateJavaScript_completionHandler(\n              CONSTANTS.JS_BRIDGE_RESULT_SUCCESS +\n                id +\n                '(' +\n                JSON.stringify(res) +\n                ')',\n              null\n            )\n          })\n          .catch(function (err) {\n            webview.evaluateJavaScript_completionHandler(\n              CONSTANTS.JS_BRIDGE_RESULT_ERROR +\n                id +\n                '(' +\n                JSON.stringify(err) +\n                ')',\n              null\n            )\n          })\n      },\n      parseWebArguments: parseWebArguments,\n    },\n  })\n\n  webview\n    .configuration()\n    .userContentController()\n    .addScriptMessageHandler_name(webScriptHandler, CONSTANTS.JS_BRIDGE)\n\n  var utils = {\n    emit() {\n      try {\n        browserWindow.emit.apply(browserWindow, arguments)\n      } catch (err) {\n        if (\n          typeof process !== 'undefined' &&\n          process.listenerCount &&\n          process.listenerCount('uncaughtException')\n        ) {\n          process.emit('uncaughtException', err, 'uncaughtException')\n        } else {\n          console.error(err)\n          throw err\n        }\n      }\n    },\n  }\n  if (options.modal) {\n    // find the window of the document\n    var msdocument\n    if (options.parent.type === 'Document') {\n      msdocument = options.parent.sketchObject\n    } else {\n      msdocument = options.parent\n    }\n    if (msdocument && String(msdocument.class()) === 'MSDocumentData') {\n      // we only have an MSDocumentData instead of a MSDocument\n      // let's try to get back to the MSDocument\n      msdocument = msdocument.delegate()\n    }\n    utils.parentWindow = msdocument.windowForSheet()\n  }\n\n  var windowDelegate = WindowDelegateClass.new({\n    utils: utils,\n    panel: panel,\n  })\n\n  panel.setDelegate(windowDelegate)\n}\n","var EventEmitter = require('events')\nvar executeJavaScript = require('./execute-javascript')\n\n// let's try to match https://github.com/electron/electron/blob/master/docs/api/web-contents.md\nmodule.exports = function buildAPI(browserWindow, panel, webview) {\n  var webContents = new EventEmitter()\n\n  webContents.loadURL = browserWindow.loadURL\n\n  webContents.loadFile = function (/* filePath */) {\n    // TODO:\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n\n  webContents.downloadURL = function (/* filePath */) {\n    // TODO:\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n\n  webContents.getURL = function () {\n    return String(webview.URL())\n  }\n\n  webContents.getTitle = function () {\n    return String(webview.title())\n  }\n\n  webContents.isDestroyed = function () {\n    // TODO:\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n\n  webContents.focus = browserWindow.focus\n  webContents.isFocused = browserWindow.isFocused\n\n  webContents.isLoading = function () {\n    return !!webview.loading()\n  }\n\n  webContents.isLoadingMainFrame = function () {\n    // TODO:\n    return !!webview.loading()\n  }\n\n  webContents.isWaitingForResponse = function () {\n    return !webview.loading()\n  }\n\n  webContents.stop = function () {\n    webview.stopLoading()\n  }\n  webContents.reload = function () {\n    webview.reload()\n  }\n  webContents.reloadIgnoringCache = function () {\n    webview.reloadFromOrigin()\n  }\n  webContents.canGoBack = function () {\n    return !!webview.canGoBack()\n  }\n  webContents.canGoForward = function () {\n    return !!webview.canGoForward()\n  }\n  webContents.canGoToOffset = function (offset) {\n    return !!webview.backForwardList().itemAtIndex(offset)\n  }\n  webContents.clearHistory = function () {\n    // TODO:\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n  webContents.goBack = function () {\n    webview.goBack()\n  }\n  webContents.goForward = function () {\n    webview.goForward()\n  }\n  webContents.goToIndex = function (index) {\n    var backForwardList = webview.backForwardList()\n    var backList = backForwardList.backList()\n    var backListLength = backList.count()\n    if (backListLength > index) {\n      webview.loadRequest(NSURLRequest.requestWithURL(backList[index]))\n      return\n    }\n    var forwardList = backForwardList.forwardList()\n    if (forwardList.count() > index - backListLength) {\n      webview.loadRequest(\n        NSURLRequest.requestWithURL(forwardList[index - backListLength])\n      )\n      return\n    }\n    throw new Error('Cannot go to index ' + index)\n  }\n  webContents.goToOffset = function (offset) {\n    if (!webContents.canGoToOffset(offset)) {\n      throw new Error('Cannot go to offset ' + offset)\n    }\n    webview.loadRequest(\n      NSURLRequest.requestWithURL(webview.backForwardList().itemAtIndex(offset))\n    )\n  }\n  webContents.isCrashed = function () {\n    // TODO:\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n  webContents.setUserAgent = function (/* userAgent */) {\n    // TODO:\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n  webContents.getUserAgent = function () {\n    const userAgent = webview.customUserAgent()\n    return userAgent ? String(userAgent) : undefined\n  }\n  webContents.insertCSS = function (css) {\n    var source =\n      \"var style = document.createElement('style'); style.innerHTML = \" +\n      css.replace(/\"/, '\\\\\"') +\n      '; document.head.appendChild(style);'\n    var script = WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(\n      source,\n      0,\n      true\n    )\n    webview.configuration().userContentController().addUserScript(script)\n  }\n  webContents.insertJS = function (source) {\n    var script = WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(\n      source,\n      0,\n      true\n    )\n    webview.configuration().userContentController().addUserScript(script)\n  }\n  webContents.executeJavaScript = executeJavaScript(webview, browserWindow)\n  webContents.setIgnoreMenuShortcuts = function () {\n    // TODO:??\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n  webContents.setAudioMuted = function (/* muted */) {\n    // TODO:??\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n  webContents.isAudioMuted = function () {\n    // TODO:??\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n  webContents.setZoomFactor = function (factor) {\n    webview.setMagnification_centeredAtPoint(factor, CGPointMake(0, 0))\n  }\n  webContents.getZoomFactor = function (callback) {\n    callback(Number(webview.magnification()))\n  }\n  webContents.setZoomLevel = function (level) {\n    // eslint-disable-next-line no-restricted-properties\n    webContents.setZoomFactor(Math.pow(1.2, level))\n  }\n  webContents.getZoomLevel = function (callback) {\n    // eslint-disable-next-line no-restricted-properties\n    callback(Math.log(Number(webview.magnification())) / Math.log(1.2))\n  }\n  webContents.setVisualZoomLevelLimits = function (/* minimumLevel, maximumLevel */) {\n    // TODO:??\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n  webContents.setLayoutZoomLevelLimits = function (/* minimumLevel, maximumLevel */) {\n    // TODO:??\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n\n  // TODO:\n  // webContents.undo = function() {\n  //   webview.undoManager().undo()\n  // }\n  // webContents.redo = function() {\n  //   webview.undoManager().redo()\n  // }\n  // webContents.cut = webview.cut\n  // webContents.copy = webview.copy\n  // webContents.paste = webview.paste\n  // webContents.pasteAndMatchStyle = webview.pasteAsRichText\n  // webContents.delete = webview.delete\n  // webContents.replace = webview.replaceSelectionWithText\n\n  webContents.send = function () {\n    const script =\n      'window.postMessage({' +\n      'isSketchMessage: true,' +\n      \"origin: '\" +\n      String(__command.identifier()) +\n      \"',\" +\n      'args: ' +\n      JSON.stringify([].slice.call(arguments)) +\n      '}, \"*\")'\n    webview.evaluateJavaScript_completionHandler(script, null)\n  }\n\n  webContents.getNativeWebview = function () {\n    return webview\n  }\n\n  browserWindow.webContents = webContents\n}\n","/* globals NSThread */\nvar threadDictionary = NSThread.mainThread().threadDictionary()\n\nmodule.exports.getWebview = function (identifier) {\n  return require('./lib').fromId(identifier) // eslint-disable-line\n}\n\nmodule.exports.isWebviewPresent = function isWebviewPresent(identifier) {\n  return !!threadDictionary[identifier]\n}\n\nmodule.exports.sendToWebview = function sendToWebview(identifier, evalString) {\n  if (!module.exports.isWebviewPresent(identifier)) {\n    return\n  }\n\n  var panel = threadDictionary[identifier]\n  var webview = null\n  var subviews = panel.contentView().subviews()\n  for (var i = 0; i < subviews.length; i += 1) {\n    if (\n      !webview &&\n      !subviews[i].isKindOfClass(WKInspectorWKWebView) &&\n      subviews[i].isKindOfClass(WKWebView)\n    ) {\n      webview = subviews[i]\n    }\n  }\n\n  if (!webview || !webview.evaluateJavaScript_completionHandler) {\n    throw new Error('Webview ' + identifier + ' not found')\n  }\n\n  webview.evaluateJavaScript_completionHandler(evalString, null)\n}\n","module.exports = \"file://\" + String(context.scriptPath).split(\".sketchplugin/Contents/Sketch\")[0] + \".sketchplugin/Contents/Resources/_webpack_resources/9ca04b794fc2963f70b60065ab21f4d6.html\";","module.exports = \"file://\" + String(context.scriptPath).split(\".sketchplugin/Contents/Sketch\")[0] + \".sketchplugin/Contents/Resources/_webpack_resources/199f6beed47a9a03633325b069f670b7.html\";","import * as colorCalc from \"./colorCalculations\";\n\nexport const isArsenicDesignSystem = (sharedLayerStyles) => {\n  try {\n    // Check if this file has the Arsenic Styles available or not.\n    const isArsenic = sharedLayerStyles.filter(\n      (layer) =>\n        (layer.name.match(\".*Primary\") ||\n          layer.name.match(\".*Secondary\") ||\n          layer.name.match(\".*Tertiary\")) &&\n        layer.name.match(\".*Base-500$\")\n    );\n\n    if (isArsenic.length <= 0) {\n      // This file do not contains the Arsenic Design Styles.\n      // Show Alert to the user that wrong file has been selected.\n      console.log(\"🚨 This is NOT an Arsenic design system.\");\n      return false;\n    } else {\n      console.log(\"This is Arsenic design system.\");\n      return true;\n    }\n  } catch (err) {\n    console.log(err, \"error in isArsenicDesignSystem\");\n  }\n};\n\nexport const capitalizeString = (inputString) => {\n  return inputString.charAt(0).toUpperCase() + inputString.slice(1);\n};\n\nexport const updatePrimaryBorders = (allLayerStyles, colorToReplace, regex) => {\n  try {\n    // Filter the array based on value\n    let filteredLayers = allLayerStyles.filter((layer) =>\n      layer.name.match(regex)\n    );\n\n    if (filteredLayers.length > 0) {\n      updateBorderLayers(filteredLayers, colorToReplace);\n    }\n  } catch (err) {\n    console.log(err, \"error in updatePrimaryBorders\");\n  }\n};\n\nexport function changeColorShadeAssets(\n  allLayerStyles,\n  hexColorCode,\n  whichColors,\n  minL,\n  maxL\n) {\n  try {\n    console.log(\"in changeColorShadeAssets\");\n    const selectedColor = colorCalc.hexToHSL(hexColorCode);\n\n    const numOfNuances = 4;\n    let j = 1;\n    for (let i = 4; i >= 1; i--) {\n      const colorRegex = \".*\" + whichColors + \"-\" + i + \"00$\";\n      let colorCode = colorCalc.calLigntness(\n        selectedColor,\n        numOfNuances,\n        minL,\n        maxL,\n        j,\n        false\n      );\n      updatePrimaryBorders(allLayerStyles, colorCode, colorRegex);\n      j++;\n    }\n\n    const colorRegex500 = \".*\" + whichColors + \"-500$\";\n    updatePrimaryBorders(allLayerStyles, hexColorCode, colorRegex500);\n    let k = 3;\n    for (let i = 6; i <= 9; i++) {\n      console.log(k, \"===> k\");\n      const colorRegex = \".*\" + whichColors + \"-\" + i + \"00$\";\n      let colorCode = colorCalc.calLigntness(\n        selectedColor,\n        numOfNuances,\n        minL,\n        maxL,\n        k,\n        true\n      );\n      updatePrimaryBorders(allLayerStyles, colorCode, colorRegex);\n      k--;\n    }\n  } catch (err) {\n    console.log(err, \"error in changeColorShadeAssets\");\n  }\n}\n\nconst updateBorderLayers = (sharedLayerStyles, colorToReplace) => {\n  try {\n    // get IDs of shared layer styles\n    sharedLayerStyles.forEach((sharedStyle) => {\n      if (sharedStyle.type == \"SharedStyle\") {\n        // Update the Fill color in Style.\n        if (sharedStyle.style.fills.length > 0) {\n          sharedStyle.style.fills[0].color = colorToReplace;\n        }\n\n        // Update the Border color in Style.\n        if (sharedStyle.style.borders.length > 0) {\n          sharedStyle.style.borders[0].color = colorToReplace;\n        }\n\n        // Get all the instance of the layer which are using the same Shared Layer Styles.\n        const arrStyleLayers = sharedStyle.getAllInstancesLayers();\n        // Loop through all the layers and update the layer style.\n        arrStyleLayers.forEach(function (aCurrentStyleLayer, i) {\n          aCurrentStyleLayer.style.syncWithSharedStyle(sharedStyle);\n        });\n      }\n    });\n  } catch (err) {\n    console.log(err, \"error in updateBorderLayers\");\n  }\n};\n","export const RGBToHSL = (r, g, b) => {\n  // Make r, g, and b fractions of 1\n  r /= 255;\n  g /= 255;\n  b /= 255;\n\n  // Find greatest and smallest channel values\n  let cmin = Math.min(r, g, b),\n    cmax = Math.max(r, g, b),\n    delta = cmax - cmin,\n    h = 0,\n    s = 0,\n    l = 0;\n};\n\nexport const hexToHSL = (H) => {\n  // Convert hex to RGB first\n  let r = 0,\n    g = 0,\n    b = 0;\n  if (H.length == 4) {\n    r = \"0x\" + H[1] + H[1];\n    g = \"0x\" + H[2] + H[2];\n    b = \"0x\" + H[3] + H[3];\n  } else if (H.length == 7) {\n    r = \"0x\" + H[1] + H[2];\n    g = \"0x\" + H[3] + H[4];\n    b = \"0x\" + H[5] + H[6];\n  }\n  // Then to HSL\n  r /= 255;\n  g /= 255;\n  b /= 255;\n  let cmin = Math.min(r, g, b),\n    cmax = Math.max(r, g, b),\n    delta = cmax - cmin,\n    h = 0,\n    s = 0,\n    l = 0;\n\n  if (delta == 0) h = 0;\n  else if (cmax == r) h = ((g - b) / delta) % 6;\n  else if (cmax == g) h = (b - r) / delta + 2;\n  else h = (r - g) / delta + 4;\n\n  h = Math.round(h * 60);\n\n  if (h < 0) h += 360;\n\n  l = (cmax + cmin) / 2;\n  s = delta == 0 ? 0 : delta / (1 - Math.abs(2 * l - 1));\n  s = +(s * 100).toFixed(1);\n  l = +(l * 100).toFixed(1);\n  return { h: h, s: s, l: l };\n  //   \"hsl(\" + h + \",\" + s + \"%,\" + l + \"%)\";\n};\n\nexport const HSLToHex = (h, s, l) => {\n  s /= 100;\n  l /= 100;\n\n  let c = (1 - Math.abs(2 * l - 1)) * s,\n    x = c * (1 - Math.abs(((h / 60) % 2) - 1)),\n    m = l - c / 2,\n    r = 0,\n    g = 0,\n    b = 0;\n\n  if (0 <= h && h < 60) {\n    r = c;\n    g = x;\n    b = 0;\n  } else if (60 <= h && h < 120) {\n    r = x;\n    g = c;\n    b = 0;\n  } else if (120 <= h && h < 180) {\n    r = 0;\n    g = c;\n    b = x;\n  } else if (180 <= h && h < 240) {\n    r = 0;\n    g = x;\n    b = c;\n  } else if (240 <= h && h < 300) {\n    r = x;\n    g = 0;\n    b = c;\n  } else if (300 <= h && h < 360) {\n    r = c;\n    g = 0;\n    b = x;\n  }\n  // Having obtained RGB, convert channels to hex\n  r = Math.round((r + m) * 255).toString(16);\n  g = Math.round((g + m) * 255).toString(16);\n  b = Math.round((b + m) * 255).toString(16);\n\n  // Prepend 0s, if necessary\n  if (r.length == 1) r = \"0\" + r;\n  if (g.length == 1) g = \"0\" + g;\n  if (b.length == 1) b = \"0\" + b;\n\n  return \"#\" + r + g + b;\n};\n\nexport const calLigntness = (\n  selectedColor,\n  numOfNuances,\n  minL,\n  maxL,\n  i,\n  isDark\n) => {\n  const selectedLightness = Math.round(selectedColor.l);\n\n  const maxLightness = parseInt(maxL) || 100;\n  const maxStep = (maxLightness - selectedLightness) / numOfNuances;\n\n  const minLightness = parseInt(minL) || 0;\n  const minStep = (selectedLightness - minLightness) / numOfNuances;\n\n  const lightNess = isDark\n    ? Math.round(minLightness + minStep * i)\n    : Math.round(selectedLightness + maxStep * i);\n\n  // const factor = isDark\n  //   ? (maxL - selectedLightness) / numOfNuances\n  //   : (selectedLightness - minL) / numOfNuances;\n  // //console.log(factor, \"&&&> factor\");\n  // //console.log(selectedColor.l, \"===> selectedColor.l\");\n  // const calculateFactor = i * factor;\n  // let lightNess = isDark\n  //   ? minL + calculateFactor\n  //   : selectedLightness + calculateFactor;\n  console.log(lightNess, \"***> lightNess\");\n  console.log(\n    HSLToHex(selectedColor.h, selectedColor.s, Math.round(lightNess)),\n    \"====> Final HEX\"\n  );\n  return HSLToHex(selectedColor.h, selectedColor.s, lightNess);\n\n  //const maxThreshold = (max - l) / 4;\n};\n","import BrowserWindow from \"sketch-module-web-view\";\nimport { getWebview } from \"sketch-module-web-view/remote\";\nimport UI from \"sketch/ui\";\nimport sketch from \"sketch\";\nimport * as sketchAssets from \"./changeSketchAssets\";\n\nconst webviewIdentifier = \"arsenic-core.webview\";\nconst document = sketch.getSelectedDocument();\n\n// const documentName = splitDocPath.length\n// const allDocuments = require(\"sketch/dom\").getDocuments();\n// const ArsenicDocs = [];\n// for (let i = 0; i < allDocuments.length; i++) {\n//   const allLayerDocStyles = allDocuments[i].sharedLayerStyles;\n//   if (sketchAssets.isArsenicDesignSystem(allLayerDocStyles) == false) {\n//     console.log(\"🚨 This is NOT an Arsenic design system.\");\n//   } else {\n//     console.log(allDocuments[i].path, \"This is an Arsenic design system.\");\n//   }\n// }\n\nexport default function () {\n  const options = {\n    identifier: webviewIdentifier,\n    width: 800,\n    height: 610,\n    show: false,\n    resizable: false,\n    movable: true,\n    fullscreen: false,\n  };\n\n  const browserWindow = new BrowserWindow(options);\n  // Stores base Colors\n  let baseColors = [];\n  let isArsenic = true;\n\n  const webContents = browserWindow.webContents;\n  const allLayerStyles = document.sharedLayerStyles;\n\n  if (sketchAssets.isArsenicDesignSystem(allLayerStyles) == false) {\n    isArsenic = false;\n  }\n\n  // only show the window when the page has loaded to avoid a white flash\n  browserWindow.once(\"ready-to-show\", () => {\n    browserWindow.show();\n  });\n\n  // print a message when the page loads\n  webContents.on(\"did-finish-load\", () => {\n    try {\n      // Check if this is Arsenic design system or not.\n      if (sketchAssets.isArsenicDesignSystem(allLayerStyles) == false) {\n        UI.message(\"🚨 This is NOT an Arsenic design system.\");\n      } else {\n        //UI.message(\"✅ Arsenic Library plugin loaded successfully!\");\n        const splitDocPath = document.path.split(\"/\");\n        const documentName = splitDocPath[splitDocPath.length - 1];\n        webContents\n          .executeJavaScript(\n            `setOpenDocumentName(${JSON.stringify(documentName)})`\n          )\n          .catch(console);\n        getBase500Colors(allLayerStyles);\n        getFontsList();\n      }\n    } catch (err) {\n      console.log(err, \"🧨 error in did-finish-load\");\n    }\n  });\n\n  // add a handler for a call from web content's javascript\n  webContents.on(\n    \"doUpdateColors\",\n    (inputId, hexColor, minLuminence, maxLuminence) => {\n      try {\n        const swatchName = sketchAssets.capitalizeString(inputId);\n        //const sketchVersion = MSApplicationMetadata.metadata().appVersion;\n\n        //if (sketchVersion >= 69) {\n        const swatchContainer = document.sketchObject\n          .documentData()\n          .sharedSwatches();\n        const mySwatchs = swatchContainer.swatches();\n        const allLayerStyles = document.sharedLayerStyles;\n\n        let isColorExist = baseColors.find((data) => {\n          if (data.name == inputId && data.value == hexColor + \"ff\")\n            return true;\n          else return false;\n        });\n        // if (!isColorExist) {\n        // mySwatchs.forEach(function (swatch) {\n        for (let i = 0; i < mySwatchs.length; i++) {\n          const swatch = mySwatchs[i];\n\n          if (sketchAssets.capitalizeString(swatch.name()) == swatchName) {\n            let newHexColor = MSColor.colorWithHex_alpha(hexColor, 1.0);\n            swatch.updateWithColor(newHexColor);\n            swatchContainer.updateReferencesToSwatch(swatch);\n            sketchAssets.changeColorShadeAssets(\n              allLayerStyles,\n              hexColor,\n              swatchName,\n              minLuminence,\n              maxLuminence\n            );\n            const regex = \".*\" + swatchName + \"-Outline-.*px 50$\";\n            sketchAssets.updatePrimaryBorders(\n              allLayerStyles,\n              newHexColor,\n              regex\n            );\n          }\n        }\n        //}\n        //}\n      } catch (err) {\n        UI.message(\"⛔️ Unable to update colors!\");\n        console.log(err, \"🧨 error in doUpdateColors\");\n      }\n    }\n  );\n\n  // add a handler for a call from web content's javascript\n  webContents.on(\"doUpdateFonts\", (fontTypeLayers, fontName) => {\n    try {\n      const newFontTypeLayers = fontTypeLayers.replace(\"-\", \" \");\n      updateFontStyle(fontName, newFontTypeLayers);\n    } catch (err) {\n      UI.message(\"⛔️ Unable to update font styles!\");\n      console.log(err, \"🧨 error in doUpdateColors\");\n    }\n  });\n\n  // add a handler for a call from web content's javascript\n  webContents.on(\"setMessage\", (whichElement) => {\n    try {\n      if (whichElement === \"colors\")\n        UI.message(\"✅ Colors has been updated successfully!\");\n      else UI.message(\"✅ Font style has been updated successfully!\");\n    } catch (err) {\n      console.log(err, \"🧨 error in doUpdateColors\");\n    }\n  });\n\n  webContents.on(\"doResetColor\", (inputId) => {\n    const initialColors = getBase500Colors(allLayerStyles, true);\n    let isColorExist = initialColors.find((data) => {\n      if (data.name == inputId) return true;\n      else return false;\n    });\n    console.log(isColorExist, \"isColorExist in doResetColor\");\n    webContents\n      .executeJavaScript(\n        `setInitialColors(${JSON.stringify(isColorExist)}, true)`\n      )\n      .catch(console);\n  });\n  // add a handler for a call from web content's javascript\n  webContents.on(\"closeWebView\", () => {\n    try {\n      onShutdown();\n    } catch (err) {\n      console.log(err, \"🧨 error in closeWebView\");\n    }\n  });\n\n  webContents.on(\"openExternalLink\", (url) => {\n    try {\n      console.log(url, \"entered in openExternalLink\");\n      NSWorkspace.sharedWorkspace().openURL(NSURL.URLWithString(url));\n      onShutdown();\n    } catch (err) {\n      console.log(err, \"🧨 error in openExternalLink\");\n    }\n  });\n\n  webContents.on(\"getFonts\", () => {\n    try {\n      getFontsList();\n    } catch (err) {\n      console.log(err, \"🧨 error in getFonts\");\n    }\n  });\n\n  const getFontsList = () => {\n    const availableFontFamilies =\n      NSFontManager.sharedFontManager().availableFontFamilies();\n    const arrayFontList = Array.from(availableFontFamilies);\n    const objFontList = Object.entries(arrayFontList);\n\n    for (let i = 0; i < objFontList.length; i++) {\n      webContents\n        .executeJavaScript(\n          `setInitialFonts(${JSON.stringify(String(objFontList[i][1]))})`\n        )\n        .catch(console);\n    }\n  };\n\n  const updateFontStyle = (fontName, fontTypeLayers) => {\n    // Filter the array based on value\n    const textStyles = document.sharedTextStyles;\n    let filteredTextStylesToUpdate = textStyles.filter((layer) => {\n      // \"Primary/.*\\Outline-1px$\"\n      // \".*\\Outline-.*\\px$\"\n      return layer.name.match(fontTypeLayers + \"/.*\");\n    });\n\n    // Now as per the selection of the user from the plugin, update the text styles.\n    filteredTextStylesToUpdate.length > 0 &&\n      filteredTextStylesToUpdate.forEach(function (sharedStyle, i) {\n        if (sharedStyle.type == \"SharedStyle\") {\n          // Get all the instance of the layer which are using the same Shared Layer Styles.\n          // Update the Shared Text layer Styles\n          sharedStyle.style.fontFamily = fontName;\n\n          const layers = sharedStyle.getAllInstancesLayers();\n\n          // Loop through all the layers and update the layer style.\n          layers.forEach(function (fontLayers, i) {\n            if (fontLayers.type == \"Text\") {\n              fontLayers.style.syncWithSharedStyle(sharedStyle);\n            }\n          });\n        } else {\n          console.log(\"❌ Not a Shared Style\");\n        }\n      });\n    return true;\n  };\n\n  const getBase500Colors = (layerStyles, isReset) => {\n    try {\n      // Filter the array based on value\n      let filteredBaseLayers = layerStyles.filter((layer) =>\n        // \"Primary/.*\\Outline-1px$\"\n        // \".*\\Outline-.*\\px$\"\n        layer.name.match(\".*Base-500$\")\n      );\n\n      // get IDs of shared layer styles\n      filteredBaseLayers.map(function (sharedLayerStyle, key) {\n        // filteredBaseLayers.forEach((sharedLayerStyle) => {\n        if (sharedLayerStyle.style.fills.length > 0) {\n          const colorName = sharedLayerStyle.name.split(/[/0-9 \\?&]/g);\n          let colorCodeObj = {\n            name: colorName[3].toLowerCase(),\n            value: sharedLayerStyle.style.fills[0].color,\n            isPrimary: key === 0 ? true : false,\n            isColorChanged: false,\n          };\n          baseColors.push(colorCodeObj);\n          if (!isReset) {\n            webContents\n              .executeJavaScript(\n                `setInitialColors(${JSON.stringify(colorCodeObj)})`\n              )\n              .catch(console);\n          }\n        }\n      });\n      return baseColors;\n    } catch (err) {\n      console.log(err, \"error in getBase500Colors\");\n    }\n  };\n\n  if (isArsenic) {\n    browserWindow.loadURL(require(\"../resources/plugin-options.html\"));\n  } else {\n    browserWindow.loadURL(require(\"../resources/index.html\"));\n  }\n}\n\n// When the plugin is shutdown by Sketch (for example when the user disable the plugin)\n// we need to close the webview if it's open\nexport function onShutdown() {\n  const existingWebview = getWebview(webviewIdentifier);\n  if (existingWebview) {\n    existingWebview.close();\n  }\n}\n","module.exports = require(\"events\");","module.exports = require(\"sketch\");","module.exports = require(\"sketch/ui\");"],"sourceRoot":""}